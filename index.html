<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>–†–∞–¥—É–≥–∞ PRO</title>
    <style>
        body {
            display: flex;
            flex-direction: column;
            align-items: center;
            font-family: 'Arial', sans-serif;
            background: #f8f9fa;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
        }

        #gameContainer {
            width: 300px;
            height: 75px;
            margin: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            transition: transform 0.1s;
            position: relative;
        }

        #gameContainer:active {
            transform: scale(0.98);
        }

        .word {
            font-size: 24px;
            font-weight: 700;
            user-select: none;
            text-transform: uppercase;
        }

        #controls {
            display: flex;
            gap: 15px;
            margin-bottom: 25px;
            flex-wrap: wrap;
            justify-content: center;
        }

        button {
            padding: 12px 25px;
            font-size: 14px;
            cursor: pointer;
            border: none;
            border-radius: 8px;
            background: linear-gradient(135deg, #6c5ce7, #a8a4e6);
            color: white;
            font-weight: 600;
            transition: all 0.2s;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        button:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
        }

        button:active {
            transform: translateY(0);
        }

        .hidden {
            display: none;
        }

        #score {
            font-size: 28px;
            margin: 15px;
            color: #2d3436;
            font-weight: 700;
        }

        #timer {
            font-size: 24px;
            color: #2d3436;
            margin: 10px;
            font-weight: 600;
        }

        .progress-bar {
            width: 300px;
            height: 8px;
            background-color: #eee;
            border-radius: 4px;
            margin: 10px 0;
            overflow: hidden;
        }

        .progress {
            height: 100%;
            background: linear-gradient(90deg, #6c5ce7, #a8a4e6);
            transition: width 0.1s linear;
        }
		
		.training-container {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 300px;
            background: white;
            border: 1px solid #ccc;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            display: none;
            font-family: Arial, sans-serif;
            z-index: 1000;
        }
        
        .training-close-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            cursor: pointer;
            font-size: 20px;
            line-height: 1;
        }
        
        .training-step {
            display: none;
            text-align: center;
        }
        
        .training-step.active {
            display: block;
        }
        
        .training-emoji {
            font-size: 40px;
            margin: 10px 0;
        }
        
        .training-navigation {
            margin-top: 20px;
            display: flex;
            justify-content: space-between;
            gap: 10px;
        }
        
        /* –°–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –∫–ª–∞—Å—Å—ã –¥–ª—è –∫–Ω–æ–ø–æ–∫ */
        .training-btn {
            padding: 8px 16px;
            cursor: pointer;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 4px;
            font-family: Arial, sans-serif;
            font-size: 14px;
        }
        
        .training-btn:hover {
            background: #0056b3;
        }
        
        /* –°—Ç–∏–ª—å —Ç–æ–ª—å–∫–æ –¥–ª—è –ø–µ—Ä–≤–æ–≥–æ —à–∞–≥–∞ */
        .training-step[data-step="1"] .training-navigation {
            justify-content: flex-end;
        }
		  #global-timer {
        font-size: 32px;
        font-weight: 700;
        color: #2d3436;
        margin: 15px 0;
        font-family: 'Arial', sans-serif;
    }
    </style>
</head>
<body>
    <div id="score">0</div>
    <div id="timer">–í—Ä–µ–º—è: 5.0—Å</div>
    <div class="progress-bar">
        <div class="progress" style="width: 100%"></div>
    </div>
    <div id="gameContainer" class="hidden">
        <div class="word"></div>
    </div>
    <div id="controls">
        <button id="modeButton">–†–µ–∂–∏–º: –°–æ–≤–ø–∞–¥–µ–Ω–∏–µ</button>
        <button id="startButton">–°—Ç–∞—Ä—Ç</button>
    </div>
<div class="training-container" id="trainingContainer">
        <div class="training-close-btn" onclick="trainingClose()">√ó</div>
        
        <div class="training-step active" data-step="1">
            <div class="training-emoji">üéØ</div>
            <h3 class="training-title">–£–ª—É—á—à–∏ —Å–≤–æ–∏ –∫–æ–≥–Ω–∏—Ç–∏–≤–Ω—ã–µ –Ω–∞–≤—ã–∫–∏</h3>
            <p class="training-text">–ö–ª–∏–∫–∞–π –ø–æ —Å–ª–æ–≤—É, –µ—Å–ª–∏ —Ü–≤–µ—Ç —Å–ª–æ–≤–∞ —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å –µ–≥–æ –∑–Ω–∞—á–µ–Ω–∏–µ–º. –ö–ª–∏–∫–∞–π –≤–Ω–µ —Å–ª–æ–≤–∞, –µ—Å–ª–∏ –Ω–µ —Å–æ–≤–ø–∞–¥–∞–µ—Ç.</p>
            <div class="training-navigation">
                <button class="training-btn" onclick="trainingNextStep()">–î–∞–ª–µ–µ</button>
            </div>
        </div>
        
        <div class="training-step" data-step="2">
            <div class="training-emoji">üìö</div>
            <h3 class="training-title">–¢—Ä–µ–Ω–∏—Ä—É–π—Å—è –µ–∂–µ–¥–Ω–µ–≤–Ω–æ</h3>
            <p class="training-text">–í –ø—Ä–æ—Ü–µ—Å—Å–µ —Å–∫–æ—Ä–æ—Å—Ç—å –ø—Ä–∏–Ω—è—Ç–∏—è —Ä–µ—à–µ–Ω–∏–π –±—É–¥–µ—Ç —Å–æ–∫—Ä–∞—â–∞—Ç—å—Å—è. –£—Å–ø–µ–≤–∞–π –∑–∞ —Ç–∞–π–º–µ—Ä–æ–º –∏–Ω–∞—á–µ –±—É–¥–µ—Ç —Å–ø–∏—Å–∞–Ω –±–∞–ª–ª.</p>
            <div class="training-navigation">
                <button class="training-btn" onclick="trainingPrevStep()">–ù–∞–∑–∞–¥</button>
                <button class="training-btn" onclick="trainingNextStep()">–î–∞–ª–µ–µ</button>
            </div>
        </div>
        
        <div class="training-step" data-step="3">
            <div class="training-emoji">üèÜ</div>
            <h3 class="training-title">–£—Å–ª–æ–∂–Ω—è–π —Å–≤–æ–∏ –Ω–∞–≤—ã–∫–∏</h3>
            <p class="training-text">–°–º–µ–Ω–∏ —Ä–µ–∂–∏–º –Ω–∞ –æ–±—Ä–∞—Ç–Ω—ã–π –∏ –∫–ª–∏–∫–∞–π –Ω–∞ —Å–ª–æ–≤–∞ –ø—Ä–∏ –ù–ï —Å–æ–≤–ø–∞–¥–µ–Ω–∏–∏ –∏ –≤–Ω–µ —Å–ª–æ–≤–∞ –ø—Ä–∏ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–∏.</p>
            <div class="training-navigation">
                <button class="training-btn" onclick="trainingPrevStep()">–ù–∞–∑–∞–¥</button>
                <button class="training-btn" onclick="trainingComplete()">–ó–∞–≤–µ—Ä—à–∏—Ç—å</button>
            </div>
        </div>
    </div>

    <script>
        (function() {
            // –£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –Ω–∞–∑–≤–∞–Ω–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
            const trainingCurrentStep = {
                value: 1
            };
            
            const trainingPanel = document.getElementById('trainingContainer');
            
            function trainingCheckCookie() {
                if (!document.cookie.includes('training_completed=true')) {
                    trainingPanel.style.display = 'block';
                }
            }
            
            function trainingSetCookie() {
                const date = new Date();
                date.setFullYear(date.getFullYear() + 1);
                document.cookie = `training_completed=true; expires=${date.toUTCString()}; path=/`;
            }
            
            function trainingUpdateSteps() {
                document.querySelectorAll('.training-step').forEach(step => {
                    step.classList.remove('active');
                    if(parseInt(step.dataset.step) === trainingCurrentStep.value) {
                        step.classList.add('active');
                    }
                });
            }
            
            window.trainingNextStep = function() {
                if(trainingCurrentStep.value < 3) {
                    trainingCurrentStep.value++;
                    trainingUpdateSteps();
                }
            }
            
            window.trainingPrevStep = function() {
                if(trainingCurrentStep.value > 1) {
                    trainingCurrentStep.value--;
                    trainingUpdateSteps();
                }
            }
            
            window.trainingComplete = function() {
                trainingPanel.style.display = 'none';
                trainingSetCookie();
            }
            
            window.trainingClose = function() {
                trainingPanel.style.display = 'none';
                trainingSetCookie();
            }
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
            window.addEventListener('load', trainingCheckCookie);
        })();
		
		
		
		

        const colors = ['–∫—Ä–∞—Å–Ω—ã–π', '–∑–µ–ª—ë–Ω—ã–π', '—Å–∏–Ω–∏–π', '—á—ë—Ä–Ω—ã–π', '–±–µ–ª—ã–π', '—Ñ–∏–æ–ª–µ—Ç–æ–≤—ã–π', '–∂—ë–ª—Ç—ã–π'];
        const colorMap = {
            '–∫—Ä–∞—Å–Ω—ã–π': 'red',
            '–∑–µ–ª—ë–Ω—ã–π': 'green',
            '—Å–∏–Ω–∏–π': 'blue',
            '—á—ë—Ä–Ω—ã–π': 'black',
            '–±–µ–ª—ã–π': 'white',
            '—Ñ–∏–æ–ª–µ—Ç–æ–≤—ã–π': 'purple',
            '–∂—ë–ª—Ç—ã–π': 'yellow'
        };

        let isGameActive = false;
        let isWordVisible = false;
        let score = 0;
        let mode = 'match';
        let currentTimeLimit = 5000;
        let timerId = null;
        let roundTimeout = null;
		
		
    let globalTime = 180; // 3 –º–∏–Ω—É—Ç—ã –≤ —Å–µ–∫—É–Ω–¥–∞—Ö
    let globalTimerId = null;
    const globalTimerElement = document.createElement('div');
    globalTimerElement.id = 'global-timer';
    document.body.insertBefore(globalTimerElement, document.getElementById('score'));
	
	    function colorNameToHex(color) {
        const colors = {
            'red': '#ff0000',
            'green': '#008000',
            'blue': '#0000ff',
            'black': '#000000',
            'white': '#ffffff',
            'purple': '#800080',
            'yellow': '#ffff00'
        };
        return colors[color.toLowerCase()] || '#000000';
    }
	
	// –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ —è—Ä–∫–æ—Å—Ç–∏ —Ü–≤–µ—Ç–∞
    function getLuminance(hex) {
        const rgb = parseInt(hex.substring(1), 16);
        const r = (rgb >> 16) & 0xff;
        const g = (rgb >> 8) & 0xff;
        const b = (rgb >> 0) & 0xff;
        return 0.2126 * r + 0.7152 * g + 0.0722 * b;
    }

    // –ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ñ–æ–Ω–∞
 function generateRandomColor(textColorName) {
        const textColorHex = colorNameToHex(textColorName);
        let bgColor, bgLum, textLum, contrast;
        do {
            bgColor = '#' + Math.floor(Math.random()*16777215).toString(16).padStart(6, '0');
            bgLum = getLuminance(bgColor);
            textLum = getLuminance(textColorHex);
            contrast = (Math.max(bgLum, textLum) + 0.05) / (Math.min(bgLum, textLum) + 0.05);
        } while (contrast < 3.5);
        return bgColor;
    }

    // –û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è showWord
    function showWord() {
        const word = colors[Math.floor(Math.random() * colors.length)];
        const shouldMatch = Math.random() < 0.5;
        const textColorName = shouldMatch ? colorMap[word] : colorMap[getRandomColor(word)];
        
        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç—Ä–∞—Å—Ç–Ω–æ–≥–æ —Ñ–æ–Ω–∞
        const bgColor = generateRandomColor(textColorName);
        
        wordElement.textContent = word;
        gameContainer.style.color = textColorName;
        gameContainer.style.backgroundColor = bgColor;
        
        gameContainer.classList.remove('hidden');
        isWordVisible = true;
        startTimer(currentTimeLimit);
    }

    // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è –≥–ª–æ–±–∞–ª—å–Ω–æ–≥–æ —Ç–∞–π–º–µ—Ä–∞
    function updateGlobalTimer() {
        if (!isGameActive) return;
        
        const minutes = Math.floor(globalTime / 60).toString().padStart(2, '0');
        const seconds = (globalTime % 60).toString().padStart(2, '0');
        globalTimerElement.textContent = `${minutes}:${seconds}`;
        
        if (globalTime <= 0) {
            stopGame();
            clearInterval(globalTimerId);
            alert("–í—Ä–µ–º—è –≤—ã—à–ª–æ! –°—á—ë—Ç: " + score);
        }
        globalTime--;
    }

    function startGame() {
        if (isGameActive) return;
        
        // –°–±—Ä–æ—Å –≥–ª–æ–±–∞–ª—å–Ω–æ–≥–æ —Ç–∞–π–º–µ—Ä–∞
        globalTime = 180;
        clearInterval(globalTimerId);
        globalTimerId = setInterval(updateGlobalTimer, 1000);
        
        // –û—Å—Ç–∞–ª—å–Ω–æ–π –∫–æ–¥
        isGameActive = true;
        isWordVisible = false;
        score = 0;
        currentTimeLimit = 5000;
        scoreElement.textContent = '0';
        startButton.textContent = '–°—Ç–æ–ø';
        nextRound();
    }

    function stopGame() {
         isGameActive = false;
        isWordVisible = false;
        resetTimer();
        clearTimeout(roundTimeout);
        startButton.textContent = '–°—Ç–∞—Ä—Ç';
        hideWord();
        updateTimerDisplay(currentTimeLimit);
        clearInterval(globalTimerId); // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –≥–ª–æ–±–∞–ª—å–Ω—ã–π —Ç–∞–π–º–µ—Ä
    }
        
        const gameContainer = document.getElementById('gameContainer');
        const wordElement = document.querySelector('.word');
        const scoreElement = document.getElementById('score');
        const timerElement = document.getElementById('timer');
        const progress = document.querySelector('.progress');
        const modeButton = document.getElementById('modeButton');
        const startButton = document.getElementById('startButton');

        function getRandomColor(exclude) {
            const availableColors = colors.filter(c => c !== exclude);
            return availableColors[Math.floor(Math.random() * availableColors.length)];
        }


        function updateTimerDisplay(time) {
            timerElement.textContent = `–í—Ä–µ–º—è: ${(time / 1000).toFixed(1)}—Å`;
        }

        function startTimer(duration) {
            let start = Date.now();
            let remaining = duration;
            
            progress.style.transition = `width ${duration}ms linear`;
            progress.style.width = '0%';
            
            timerId = setTimeout(() => {
                handleTimeExpired();
            }, duration);

            function updateProgress() {
                const passed = Date.now() - start;
                remaining = duration - passed;
                updateTimerDisplay(remaining);
                
                if (remaining > 0) {
                    requestAnimationFrame(updateProgress);
                }
            }
            
            requestAnimationFrame(updateProgress);
        }

        function handleTimeExpired() {
            if (!isGameActive) return;
            
            score = Math.max(0, score - 1);
            scoreElement.textContent = score;
            scoreElement.style.color = '#e74c3c';
            setTimeout(() => scoreElement.style.color = '#2d3436', 800);
            
            hideWord();
            nextRound();
        }

        function resetTimer() {
            clearTimeout(timerId);
            progress.style.transition = 'none';
            progress.style.width = '100%';
        }

        function hideWord() {
            gameContainer.classList.add('hidden');
            isWordVisible = false;
        }

        function handleAction(isCorrect) {
            if (!isGameActive) return;
            
            resetTimer();
            isWordVisible = false;
            
            if (isCorrect) {
                score++;
                currentTimeLimit = Math.max(900, currentTimeLimit - 100);
                scoreElement.style.color = '#2ecc71';
            } else {
                score = Math.max(0, score - 1);
                scoreElement.style.color = '#e74c3c';
            }
            
            scoreElement.textContent = score;
            setTimeout(() => scoreElement.style.color = '#2d3436', 800);
            hideWord();
            
            nextRound();
        }

        function nextRound() {
            if (!isGameActive) return;
            
            clearTimeout(roundTimeout);
            roundTimeout = setTimeout(() => {
                if (isGameActive) showWord();
            }, 900);
        }

        document.addEventListener('click', (e) => {
            if (!isGameActive || !isWordVisible) return;
            
            const isContainerClick = e.target.closest('#gameContainer');
            const currentColor = gameContainer.style.color;
            const currentWord = colorMap[wordElement.textContent.toLowerCase()];
            const isMatch = currentColor === currentWord;
            let shouldClick = mode === 'match' ? isMatch : !isMatch;

            isWordVisible = false;
            
            if (isContainerClick) {
                handleAction(shouldClick);
            } else {
                handleAction(!shouldClick);
            }
        });

        modeButton.addEventListener('click', () => {
            mode = mode === 'match' ? 'mismatch' : 'match';
            modeButton.textContent = `–†–µ–∂–∏–º: ${mode === 'match' ? '–°–æ–≤–ø–∞–¥–µ–Ω–∏–µ' : '–ù–µ—Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ'}`;
        });

        startButton.addEventListener('click', () => {
            if (isGameActive) stopGame();
            else startGame();
        });
    </script>
</body>
</html>